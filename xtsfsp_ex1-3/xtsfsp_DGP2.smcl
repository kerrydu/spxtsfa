{com}. * importing spatial weight matrices from xtsfsp_w2.mmat
. mata mata matuse xtsfsp_w2.mmat,replace
{res}{txt}{p 0 1 2}
(loading
w1[300,300],
w10[300,300],
w2[300,300],
w3[300,300],
w4[300,300],
w5[300,300],
w6[300,300],
w7[300,300],
w8[300,300],
w9[300,300])
{p_end}

{com}. local w w1 w2 w3 w4 w5 w6 w7 w8 w9 w10
{txt}
{com}. use xtsfsp_ex2.dta
{txt}
{com}. xtset id t 
{res}
{col 1}{txt:Panel variable: }{res:id}{txt: (strongly balanced)}
{p 1 16 2}{txt:Time variable: }{res:t}{txt:, }{res:{bind:1}}{txt: to }{res:{bind:10}}{p_end}
{txt}{col 10}Delta: {res}1 unit
{txt}
{com}. * initial values for estimated parameters
. mat b=(2,0.5,1,-1.5,4,-1.5,0.6,0.6)
{txt}
{com}. * fitting the model
. xtsfsp y x, cost uhet(z) wu(w2,mata) wv(w1,mata) wxvars(x) wx(`w',mata) init(b) genwxvars nolog
{res}
{txt}{col 1}Spatial frontier model(xuv-SAR){col 55}{lalign 13:Number of obs}{col 68} = {res}{ralign 8:3,000}
{txt}{col 55}{lalign 13:Wald chi2({res:2})}{col 68} = {res}{ralign 8:57442.57}
{txt}{col 1}{lalign 14:Log likelihood}{col 15} = {res}{ralign 9:-1911.966}{txt}{col 55}{lalign 13:Prob > chi2}{col 68} = {res}{ralign 8:0.0000}

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{col 1}           y{col 14}{c |} Coefficient{col 26}  Std. err.{col 38}      z{col 46}   P>|z|{col 54}     [95% con{col 67}f. interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}frontier     {txt}{c |}
{space 11}x {c |}{col 14}{res}{space 2} 1.995755{col 26}{space 2} .0083855{col 37}{space 1}  238.00{col 46}{space 3}0.000{col 54}{space 4}  1.97932{col 67}{space 3}  2.01219
{txt}{space 9}W_x {c |}{col 14}{res}{space 2} .5069275{col 26}{space 2} .0221351{col 37}{space 1}   22.90{col 46}{space 3}0.000{col 54}{space 4} .4635435{col 67}{space 3} .5503115
{txt}{space 7}_cons {c |}{col 14}{res}{space 2} .9917396{col 26}{space 2} .0127293{col 37}{space 1}   77.91{col 46}{space 3}0.000{col 54}{space 4} .9667906{col 67}{space 3} 1.016689
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{space 4}/lnsigv2 {c |}{col 14}{res}{space 2}-1.614693{col 26}{space 2} .0260257{col 37}{space 1}  -62.04{col 46}{space 3}0.000{col 54}{space 4}-1.665702{col 67}{space 3}-1.563683
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}uhet         {txt}{c |}
{space 11}z {c |}{col 14}{res}{space 2} 3.999532{col 26}{space 2}  .002155{col 37}{space 1} 1855.94{col 46}{space 3}0.000{col 54}{space 4} 3.995308{col 67}{space 3} 4.003755
{txt}{space 7}_cons {c |}{col 14}{res}{space 2} -1.69907{col 26}{space 2} .4472607{col 37}{space 1}   -3.80{col 46}{space 3}0.000{col 54}{space 4}-2.575685{col 67}{space 3}-.8224549
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}Wv           {txt}{c |}
{space 7}_cons {c |}{col 14}{res}{space 2} .5877877{col 26}{space 2} .0584046{col 37}{space 1}   10.06{col 46}{space 3}0.000{col 54}{space 4} .4733168{col 67}{space 3} .7022585
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
{res}Wu           {txt}{c |}
{space 7}_cons {c |}{col 14}{res}{space 2} .6214134{col 26}{space 2} .0008532{col 37}{space 1}  728.34{col 46}{space 3}0.000{col 54}{space 4} .6197412{col 67}{space 3} .6230857
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
         tau {c |}{col 14}{res}{space 2} .3010498{col 26}{space 2} .0003879{col 37}{space 1}  776.13{col 46}{space 3}0.000{col 54}{space 4} .3002894{col 67}{space 3} .3018098
{txt}       gamma {c |}{col 14}{res}{space 2} .2856862{col 26}{space 2} .0268157{col 37}{space 1}   10.65{col 46}{space 3}0.000{col 54}{space 4} .2323138{col 67}{space 3} .3373429
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 9}{hline 8}{hline 13}{hline 12}
Note: Wv:_cons and Wu:_cons are the transformed parameters;
      gamma and tau are their origin metrics in spatial components, repsectively.
      W_(x) represent Spatial Durbin terms W(x)
